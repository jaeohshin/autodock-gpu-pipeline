# AutoDock-GPU Docking Pipeline

This repository contains a fully automated docking pipeline using [AutoDock-GPU](https://github.com/ccsb-scripps/AutoDock-GPU), [AutoGrid](https://github.com/ccsb-scripps/AutoGrid), [MGLTools](http://mgltools.scripps.edu/), and [Meeko](https://github.com/forlilab/Meeko), scripted in Python. It is designed to batch-process ligandâ€“receptor docking jobs with high-performance GPU acceleration.

---

## ğŸ”§ Features

- âœ… Automated receptor preparation using `prepare_receptor4.py` (MGLTools)
- âœ… Ligand preparation using [**Meeko**](https://github.com/forlilab/Meeko) with fallback to `prepare_ligand4.py` (MGLTools)
- âœ… Grid map generation using [`AutoGrid`](https://github.com/ccsb-scripps/AutoGrid) (`prepare_gpf4.py` and `autogrid4`)
- âœ… Docking using `autodock_gpu_128wi` (CUDA-enabled)
- âœ… Customizable grid center and box size
- âœ… Multi-ligand batch support
- âœ… Compatible with PyMOL for pose visualization

---

## ğŸ“ Repository Structure

This modular structure supports scalable and resumable docking workflows, making it easier to manage thousands of ligands, ensemble conformations, and targets during virtual screening.

```text
virtual_screening/
â”œâ”€â”€ input/                         # Raw inputs
â”‚   â”œâ”€â”€ kinase_list.txt            # List of kinase names (e.g., ABL1, AKT1, etc.)
â”‚   â”œâ”€â”€ ligands/                   # Raw ligand files grouped by kinase
â”‚   â”‚   â””â”€â”€ ABL1/
â”‚   â”‚       â”œâ”€â”€ actives/
â”‚   â”‚       â”‚   â”œâ”€â”€ ligand_000001.sdf
â”‚   â”‚       â”‚   â””â”€â”€ ...
â”‚   â”‚       â””â”€â”€ decoys/
â”‚   â”‚           â”œâ”€â”€ ligand_010001.sdf
â”‚   â”‚           â””â”€â”€ ...
â”‚   â””â”€â”€ receptors/                 # Generated receptor conformers (e.g., from BioEmu)
â”‚       â””â”€â”€ ABL1/
â”‚           â”œâ”€â”€ receptor_0001.pdb
â”‚           â””â”€â”€ ...
â”œâ”€â”€ preprocessed/                  # Preprocessing output
â”‚   â”œâ”€â”€ ligands_pdbqt/             # Ligands converted to .pdbqt per kinase
â”‚   â”‚   â””â”€â”€ ABL1/
â”‚   â”‚       â”œâ”€â”€ actives/
â”‚   â”‚       â”‚   â”œâ”€â”€ ligand_000001.pdbqt
â”‚   â”‚       â”‚   â””â”€â”€ ...
â”‚   â”‚       â””â”€â”€ decoys/
â”‚   â”‚           â”œâ”€â”€ ligand_010001.pdbqt
â”‚   â”‚           â””â”€â”€ ...
â”‚   â”œâ”€â”€ receptors_pdbqt/           # Receptors converted to .pdbqt
â”‚   â”‚   â””â”€â”€ ABL1/
â”‚   â”‚       â”œâ”€â”€ receptor_0001.pdbqt
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ aligned_ligands/           # Ligands aligned to receptor conformations
â”‚   â”‚   â””â”€â”€ ABL1/
â”‚   â”‚       â”œâ”€â”€ ligand_aligned_0001.pdb
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ grid_centers/              # Precomputed grid centers per receptor
â”‚       â””â”€â”€ ABL1/
â”‚           â”œâ”€â”€ receptor_0001.txt
â”‚           â””â”€â”€ ...
â”œâ”€â”€ grids/                         # Grid map files generated by AutoGrid (.maps.fld)
â”‚   â””â”€â”€ ABL1/
â”‚       â””â”€â”€ receptor_0001.maps.fld
â”œâ”€â”€ docking_output/                # Docking results (DLG or best poses)
â”‚   â””â”€â”€ ABL1/
â”‚       â””â”€â”€ receptor_0001/
â”‚           â”œâ”€â”€ ligand_000001.dlg
â”‚           â””â”€â”€ ...
â”œâ”€â”€ results/                       # Summarized scores (e.g., TSV per kinase)
â”‚   â””â”€â”€ ABL1_scores.tsv
â”œâ”€â”€ logs/                          # Optional logs of each docking run
â”‚   â””â”€â”€ ABL1_receptor_0001.log
â”œâ”€â”€ scripts/                       # Python or bash helper scripts
â”‚   â”œâ”€â”€ run_vs.py                  # Full virtual screening runner
â”‚   â”œâ”€â”€ align_ligands.py           # Ligand alignment script
â”‚   â””â”€â”€ prepare_grids.py           # Grid center generation and grid file prep

```
## âš™ï¸ Dependencies

- Python 3.x
- [AutoDock-GPU](https://github.com/ccsb-scripps/AutoDock-GPU)
- [AutoGrid](https://github.com/ccsb-scripps/AutoGrid)
- [MGLTools 1.5.7](http://mgltools.scripps.edu/)
- [RDKit](https://www.rdkit.org/)
- [Meeko](https://github.com/forlilab/Meeko)


ğŸ§ª Receptor & Grid Preparation

    Receptor preparation and grid map generation are still handled by MGLTools and AutoGrid, which provide reliable .pdbqt, .gpf, and .fld generation compatible with AutoDock.

### This pipeline integrates tools developed by:
    This ensures robustness across various ligand formats and chemical quality levels.

ğŸ§ª Receptor & Grid Preparation

    Receptor preparation and grid map generation are still handled by MGLTools and AutoGrid, which provide reliable .pdbqt, .gpf, and .fld generation compatible with AutoDock.


    The Forli Lab (Meeko)

ğŸ¤ Acknowledgments

This pipeline integrates tools developed by:

    The Scripps Research Institute: AutoDock-GPU, AutoGrid, MGLTools

    The Forli Lab: Meeko
