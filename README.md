# AutoDock-GPU Docking Pipeline

This repository contains a fully automated docking pipeline using [AutoDock-GPU](https://github.com/ccsb-scripps/AutoDock-GPU), [AutoGrid](https://github.com/ccsb-scripps/AutoGrid), [MGLTools](http://mgltools.scripps.edu/), and [Meeko](https://github.com/forlilab/Meeko), scripted in Python. It is designed to batch-process ligand–receptor docking jobs with high-performance GPU acceleration.

---

## 🔧 Features

- ✅ Automated receptor preparation using `prepare_receptor4.py` (MGLTools)
- ✅ Ligand preparation using [**Meeko**](https://github.com/forlilab/Meeko) with fallback to `prepare_ligand4.py` (MGLTools)
- ✅ Grid map generation using [`AutoGrid`](https://github.com/ccsb-scripps/AutoGrid) (`prepare_gpf4.py` and `autogrid4`)
- ✅ Docking using `autodock_gpu_128wi` (CUDA-enabled)
- ✅ Customizable grid center and box size
- ✅ Multi-ligand batch support
- ✅ Compatible with PyMOL for pose visualization

---

## 📁 Repository Structure

This modular structure supports scalable and resumable docking workflows, making it easier to manage thousands of ligands, ensemble conformations, and targets during virtual screening.

```text
virtual_screening/
├── input/                         # Raw inputs
│   ├── kinase_list.txt            # List of kinase names (e.g., ABL1, AKT1, etc.)
│   ├── ligands/                   # Raw ligand files grouped by kinase
│   │   └── ABL1/
│   │       ├── actives/
│   │       │   ├── ligand_000001.sdf
│   │       │   └── ...
│   │       └── decoys/
│   │           ├── ligand_010001.sdf
│   │           └── ...
│   └── receptors/                 # Generated receptor conformers (e.g., from BioEmu)
│       └── ABL1/
│           ├── receptor_0001.pdb
│           └── ...
├── preprocessed/                  # Preprocessing output
│   ├── ligands_pdbqt/             # Ligands converted to .pdbqt per kinase
│   │   └── ABL1/
│   │       ├── actives/
│   │       │   ├── ligand_000001.pdbqt
│   │       │   └── ...
│   │       └── decoys/
│   │           ├── ligand_010001.pdbqt
│   │           └── ...
│   ├── receptors_pdbqt/           # Receptors converted to .pdbqt
│   │   └── ABL1/
│   │       ├── receptor_0001.pdbqt
│   │       └── ...
│   ├── aligned_ligands/           # Ligands aligned to receptor conformations
│   │   └── ABL1/
│   │       ├── ligand_aligned_0001.pdb
│   │       └── ...
│   └── grid_centers/              # Precomputed grid centers per receptor
│       └── ABL1/
│           ├── receptor_0001.txt
│           └── ...
├── grids/                         # Grid map files generated by AutoGrid (.maps.fld)
│   └── ABL1/
│       └── receptor_0001.maps.fld
├── docking_output/                # Docking results (DLG or best poses)
│   └── ABL1/
│       └── receptor_0001/
│           ├── ligand_000001.dlg
│           └── ...
├── results/                       # Summarized scores (e.g., TSV per kinase)
│   └── ABL1_scores.tsv
├── logs/                          # Optional logs of each docking run
│   └── ABL1_receptor_0001.log
├── scripts/                       # Python or bash helper scripts
│   ├── run_vs.py                  # Full virtual screening runner
│   ├── align_ligands.py           # Ligand alignment script
│   └── prepare_grids.py           # Grid center generation and grid file prep

```
## ⚙️ Dependencies

- Python 3.x
- [AutoDock-GPU](https://github.com/ccsb-scripps/AutoDock-GPU)
- [AutoGrid](https://github.com/ccsb-scripps/AutoGrid)
- [MGLTools 1.5.7](http://mgltools.scripps.edu/)
- [RDKit](https://www.rdkit.org/)
- [Meeko](https://github.com/forlilab/Meeko)


🧪 Receptor & Grid Preparation

    Receptor preparation and grid map generation are still handled by MGLTools and AutoGrid, which provide reliable .pdbqt, .gpf, and .fld generation compatible with AutoDock.

### This pipeline integrates tools developed by:
    This ensures robustness across various ligand formats and chemical quality levels.

🧪 Receptor & Grid Preparation

    Receptor preparation and grid map generation are still handled by MGLTools and AutoGrid, which provide reliable .pdbqt, .gpf, and .fld generation compatible with AutoDock.


    The Forli Lab (Meeko)

🤝 Acknowledgments

This pipeline integrates tools developed by:

    The Scripps Research Institute: AutoDock-GPU, AutoGrid, MGLTools

    The Forli Lab: Meeko
